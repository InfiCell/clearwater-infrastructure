_cw-run_in_signaling_namespace()
{
  local cur prev opts potenialopts
  COMPREPLY=()
  prev="${COMP_WORDS[COMP_CWORD-1]}"
  potentialopts="cw-do_backup ping tcpdump dig ip netstat"
  opts=""

  # Check which commands exist on this box
  for opt in $potentialopts; do
    if [ -n "$(which ${opt})" ]; then
      opts="${opts} ${opt}"
    fi
  done

  case "${prev}" in
    cw-do_backup|nodetool|ping|tcpdump|dig|ip|netstat)
      _command_offset 1
      ;;
    *)
      cur="${COMP_WORDS[COMP_CWORD]}"
      COMPREPLY=($(compgen -W "${opts}" -- ${cur}))
      ;;
  esac

  return 0
} &&
complete -F _cw-run_in_signaling_namespace cw-run_in_signaling_namespace
