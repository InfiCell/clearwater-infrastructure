#!/bin/bash

# This file is called run-run-in-signaling-namespace as it follows the
# convention to add a 'run' in front of the script name used by the other
# scripts calling to craft-daemon.

if [[ $EUID -ne 0 ]]
then
  # Normally the user would require root/sudo privileges in order to execute
  # commands in the signaling namespace. For users that don't have those
  # privileges but still need to run commands in the signaling namespace, we
  # send commands to the craft daemon to execute on the user's behalf. The
  # craft daemon runs as root, but places limits the commands it will accept
  # (to avoid security holes).
  /usr/share/clearwater/craft/env/bin/run_action RunInSignalingNamespace "$@"
else
  # This has been run with root/sudo privileges and so the user is allowed to
  # execute any commands in the signaling namespace. The user already has root/
  # sudo permissions so is not limited in action (like above) as they are
  # trusted already with root/sudo access.
  /usr/share/clearwater/bin/run-in-signaling-namespace "$@"
fi

